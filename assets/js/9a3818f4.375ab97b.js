"use strict";(self.webpackChunkcode_standard=self.webpackChunkcode_standard||[]).push([[629],{9554:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>r,default:()=>c,frontMatter:()=>a,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"SUBSYSTEM_STANDARDS","title":"Subsystem Standards","description":"Subsystems Overview","source":"@site/docs/SUBSYSTEM_STANDARDS.md","sourceDirName":".","slug":"/SUBSYSTEM_STANDARDS","permalink":"/190-Robot-Code-Standards/SUBSYSTEM_STANDARDS","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"AdvantageKit Standards","permalink":"/190-Robot-Code-Standards/ADVANTAGEKIT_STANDARDS"},"next":{"title":"Command Standards","permalink":"/190-Robot-Code-Standards/COMMANDS_STANDARDS"}}');var o=t(4848),i=t(8453);const a={},r="Subsystem Standards",l={},d=[{value:"Subsystems Overview",id:"subsystems-overview",level:2},{value:"Simple Example: Whiplash Intake Subsystem",id:"simple-example-whiplash-intake-subsystem",level:2},{value:"Other Examples",id:"other-examples",level:2}];function h(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,i.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.header,{children:(0,o.jsx)(n.h1,{id:"subsystem-standards",children:"Subsystem Standards"})}),"\n",(0,o.jsx)(n.h2,{id:"subsystems-overview",children:"Subsystems Overview"}),"\n",(0,o.jsx)(n.p,{children:"Subsystems split up the logic for the different parts of the robot, and control how the robot will perform the actions they are designed to do. This requires defining how the robot will interact with it's environment, whether that be in the physical world, or a physics simulation. In the real world, we do this by interacting with physical hardware, like motors, and in a physics simulation by modeling our robot's physical properties to test logic."}),"\n",(0,o.jsx)(n.p,{children:"Each subsystem must:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["Extend ",(0,o.jsx)(n.code,{children:"SubsystemBase"}),"."]}),"\n",(0,o.jsxs)(n.li,{children:["Override the ",(0,o.jsx)(n.code,{children:"periodic()"})," method.","\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"Update IO implementation with inputs - this must come before processing the inputs."}),"\n",(0,o.jsx)(n.li,{children:"Process the subsystem inputs."}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(n.li,{children:"Contain all logic for that subsystem."}),"\n",(0,o.jsx)(n.li,{children:"Contain all necessary command factories."}),"\n",(0,o.jsxs)(n.li,{children:["Not include any ",(0,o.jsx)(n.a,{href:"/190-Robot-Code-Standards/CONSTANTS_STANDARDS",children:"constants"}),"."]}),"\n"]}),"\n",(0,o.jsxs)(n.p,{children:["Robot code runs once per loop cycle, usually 20 ms (50 Hz). When the robot is running, each subclass of ",(0,o.jsx)(n.code,{children:"SubsystemBase"})," runs it's periodic method. The periodic method is where we tell the robot what to do, and under what conditions to do it."]}),"\n",(0,o.jsx)(n.h2,{id:"simple-example-whiplash-intake-subsystem",children:"Simple Example: Whiplash Intake Subsystem"}),"\n",(0,o.jsxs)(n.p,{children:["Each subsystem extends ",(0,o.jsx)(n.code,{children:"SubsystemBase"}),". This tells the robot that the code in this class is affiliated with a subsystem, and the robot will handle the code accordingly."]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-java",children:"public class WhiplashIntake extends SubsystemBase {\n"})}),"\n",(0,o.jsx)(n.p,{children:"Each subsystem has to declare the variables it will use within itself. In the intake subsystem for Whiplash, the variables are:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"IO implementation to interface with hardware/physics simulator."}),"\n",(0,o.jsx)(n.li,{children:"IO inputs to output to log file."}),"\n",(0,o.jsx)(n.li,{children:"Timer to track how long the intake possesses 2 game pieces."}),"\n",(0,o.jsx)(n.li,{children:"isIntaking Logic variable."}),"\n"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-java",children:"public class WhiplashIntake extends SubsystemBase {\n  private final WhiplashIntakeIO io;\n  private final WhiplashIntakeIOInputsAutoLogged inputs;\n\n  private final Timer doubleTimer;\n  private boolean isIntaking;\n\n  ...\n"})}),"\n",(0,o.jsx)(n.admonition,{type:"warning",children:(0,o.jsxs)(n.p,{children:["Every subsystem must have an IO implementation and a set of inputs! See ",(0,o.jsx)(n.a,{href:"/190-Robot-Code-Standards/ADVANTAGEKIT_STANDARDS",children:"AdvantageKit Standards"})," for more details"]})}),"\n",(0,o.jsx)(n.p,{children:"After declaring the variables the subsystem needs, they need to be instantiated. This occurs in the constructor:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-java",children:"public WhiplashIntake(WhiplashIntakeIO io) {\n    this.io = io;\n    inputs = new WhiplashIntakeIOInputsAutoLogged();\n\n    doubleTimer = new Timer();\n    isIntaking = false;\n  }\n"})}),"\n",(0,o.jsx)(n.admonition,{type:"tip",children:(0,o.jsx)(n.p,{children:"To improve readability, it is generally best to instantiate variables in the order they are declared."})}),"\n",(0,o.jsx)(n.p,{children:"The intake subsystem periodically has to:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"Update and log the inputs of the subsystem"}),"\n",(0,o.jsx)(n.li,{children:"Run the rollers under specific conditions"}),"\n"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-java",children:'@Override\n  public void periodic() {\n    io.updateInputs(inputs);\n    Logger.processInputs("Intake", inputs);\n\n    if (hasNoteLocked() && !hasNoteStaged()) {\n      io.setTopVoltage(-3.0);\n      doubleTimer.stop();\n      doubleTimer.reset();\n    }\n\n    if (hasNoteLocked() && hasNoteStaged() && doubleTimer.get() <= 3.0) {\n      io.setTopVoltage(-1.0);\n    }\n\n    if (hasNoteLocked() && hasNoteStaged() && doubleTimer.get() <= 0.0) {\n      io.setTopVoltage(0.0);\n      doubleTimer.start();\n    }\n\n    if (doubleTimer.get() >= 0.0 && !hasNoteStaged() && !hasNoteLocked()) {\n      io.setTopVoltage(0.0);\n      doubleTimer.stop();\n      doubleTimer.reset();\n    }\n\n    if (hasNoteLocked() && hasNoteStaged() && doubleTimer.get() >= 3.0) {\n      io.setTopVoltage(12.0);\n    }\n\n    if (inputs.middleSensor && !inputs.finalSensor) {\n      io.setTopVoltage(-1.0);\n      io.setBottomVoltage(1.0);\n      io.setAcceleratorVoltage(1.0);\n    } else if (inputs.finalSensor) {\n      io.setBottomVoltage(0.0);\n      io.setAcceleratorVoltage(0.0);\n    }\n\n    Logger.recordOutput("Intake/Timer", doubleTimer.get());\n  }\n'})}),"\n",(0,o.jsx)(n.admonition,{type:"danger",children:(0,o.jsx)(n.p,{children:"Inputs must be updated before they are processed, otherwise the inputs in the log file will be one loop cycle behind."})}),"\n",(0,o.jsx)(n.p,{children:"Subsystems can also define methods to expose inputs to other places in the code that require the subsystem:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-java",children:"  public boolean hasNoteLocked() {\n    return inputs.finalSensor;\n  }\n\n  public boolean hasNoteStaged() {\n    return inputs.intakeSensor || inputs.middleSensor;\n  }\n\n  public boolean isIntaking() {\n    return isIntaking;\n  }\n"})}),"\n",(0,o.jsxs)(n.p,{children:["In cases where the subsystem needs to react to user input or other parts of the robot, we define ",(0,o.jsx)(n.code,{children:"Command"})," structures that can be bound to events that occur elsewhere in our code:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-java",children:"  public Command intake() {\n    return Commands.sequence(\n            Commands.runOnce(() -> isIntaking = true),\n            Commands.parallel(\n                    Commands.runEnd(() -> io.setTopVoltage(-12.0), () -> io.setTopVoltage(0.0)),\n                    Commands.runEnd(\n                        () -> io.setBottomVoltage(12.0), () -> io.setBottomVoltage(0.0)),\n                    Commands.runEnd(\n                        () -> io.setAcceleratorVoltage(12.0), () -> io.setAcceleratorVoltage(0.0)))\n                .until(() -> inputs.middleSensor),\n            Commands.parallel(\n                    Commands.runEnd(() -> io.setTopVoltage(-1.0), () -> io.setTopVoltage(0.0)),\n                    Commands.runEnd(() -> io.setBottomVoltage(1.0), () -> io.setBottomVoltage(0.0)),\n                    Commands.runEnd(\n                        () -> io.setAcceleratorVoltage(1.0), () -> io.setAcceleratorVoltage(0.0)))\n                .until(() -> inputs.finalSensor))\n        .until(() -> inputs.finalSensor)\n        .finallyDo(() -> isIntaking = false);\n  }\n\n  public Command eject() {\n    return Commands.parallel(\n        Commands.runEnd(() -> io.setTopVoltage(12.0), () -> io.setTopVoltage(0.0)),\n        Commands.runEnd(() -> io.setBottomVoltage(-12.0), () -> io.setBottomVoltage(0.0)),\n        Commands.runEnd(\n            () -> io.setAcceleratorVoltage(-12.0), () -> io.setAcceleratorVoltage(0.0)));\n  }\n\n  public Command shoot() {\n    return Commands.runEnd(\n            () -> io.setAcceleratorVoltage(12.0), () -> io.setAcceleratorVoltage(0.0))\n        .withTimeout(0.25);\n  }\n"})}),"\n",(0,o.jsx)(n.admonition,{type:"info",children:(0,o.jsx)(n.p,{children:"These types of commands are called factory commands."})}),"\n",(0,o.jsx)(n.admonition,{type:"tip",children:(0,o.jsxs)(n.p,{children:["see ",(0,o.jsx)(n.a,{href:"/190-Robot-Code-Standards/COMMANDS_STANDARDS",children:"Commands Standards"})," for more information about commands."]})}),"\n",(0,o.jsxs)(n.p,{children:["Full file found here: ",(0,o.jsx)(n.a,{href:"https://github.com/Team-190/2k24-Robot-Code/blob/snaplash/src/main/java/frc/robot/subsystems/whiplash/intake/WhiplashIntake.java",children:"Whiplash Intake Subsystem"})]}),"\n",(0,o.jsx)(n.h2,{id:"other-examples",children:"Other Examples"}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.a,{href:"https://github.com/Team-190/2k24-Robot-Code/blob/snaplash/src/main/java/frc/robot/subsystems/whiplash/arm/WhiplashArm.java",children:"Whiplash's arm subsystem"})," is an example of motion profiled closed loop position control of a Single Jointed Arm."]}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.a,{href:"https://github.com/Team-190/2k24-Robot-Code/blob/snaplash/src/main/java/frc/robot/subsystems/whiplash/shooter/WhiplashShooter.java",children:"Whiplash's shooter subsystem"})," is an example of motion profiled closed loop velocity control of a flywheel shooter."]})]})}function c(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(h,{...e})}):h(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>a,x:()=>r});var s=t(6540);const o={},i=s.createContext(o);function a(e){const n=s.useContext(i);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:a(e.components),s.createElement(i.Provider,{value:n},e.children)}}}]);